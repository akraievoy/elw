#* @vtlvariable name="elw_messages" type="elw.miniweb.Message[]" *#
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<meta content="text/html; charset=UTF-8">
	<title>Approval</title>
	<link href="../css/elw.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<div id="header">
	<div id="nav">
		<a href="index">Index</a> &gt; <a href="enrolls">Enrollments</a> &gt;
		<a href="log?id=$enr.id">Group $group.name Reports</a> &gt;
		<span style="font-weight: bold">Approval</span>
	</div>
	<div id="cred">#if($auth)[&nbsp;Admin&nbsp;]&nbsp;[&nbsp;<a href="logout">X</a>&nbsp;]#{else}[&nbsp;Anonymous&nbsp;]#end</div>
	&nbsp;
</div>
<div id=messages>#foreach($m in $elw_messages)
	<div class="$m.type">$m.message</div>
#end
</div>
<div id=main>
	<h3><span title="$student.id">$student.name</span> <span title="$ass.id">$ass.name</span> <span title="$ver.id">$ver.name</span></h3>
	<div class="formArea" style="height: 22em;">
		<form method="POST" action="approve">
			#foreach($cri in $scoring.criterias)
				<div class="formLabel" style="width:24em;">$cri.name:</div>
				<div class="formField" style="width:6em;">
					<select name="$cri.id">
						#foreach($pow in $cri.pows)
							<option value="$pow" #if($score.isSetTo($cri.id, $pow))selected#end>$pow</option>
						#end
					</select>
				</div>
			#end
			<div class="formButtons"><input type="submit" value="Approve"/></div>
		</form>
	</div>
	<div style="margin: 1em auto; width: 60em;">
		<div style="float: left;">
			<h3>Code submissions</h3>
			<table cellspacing="0" align="center"><tbody>
				<tr>
					<th></th>
					<th>Date</th>
					<th>State</th>
					<th>Score</th>
					<th>Link</th>
				</tr>
#foreach($c in $codes.values())
				<tr>
					<td style="padding: 0 0.25em; text-align: center;">#if($c.uploadStamp == $codeStamp)<span style="font-weight: bold;">*</span>#else<a href="approve?path=$path&id=$id&codeStamp=$c.uploadStamp&stamp=$stamp">~</a>#end </td>
					<td style="padding: 0 0.25em;"><span title="$c.niceUploadStamp">$c.briefUploadStamp</span></td>
					<td style="padding: 0 0.25em;">
						#if($c.validatorStamp > 0)
							#set($passColor = "#if($c.testsPassed>0)#00FF00#else#999999#end")
							#set($failColor = "#if($c.testsFailed>0)#FF0000#else#999999#end")
							<span style="color: $passColor;">$c.testsPassed&nbsp;Pass</span> /
							<span style="color: $failColor;">$c.testsFailed&nbsp;Fail</span>
						#else
							Tests Pending
						#end
					</td>
					<td style="padding: 0 0.25em;">
						#set($score = $codeScores.get($c.uploadStamp))
						#if($score)
							$score.niceRatio : 
							#set($terms = $score.terms)
						  #foreach($term in $terms)
								#if($term.positive)
									#set($termColor = "#00FF00")
								#else
									#set($termColor = "#FF0000")
								#end
								<span style="color: $termColor;" title="$scoring.findCriteria($term.id).name ($term.pow)">$term.niceRatio</span>
							#end
						#else
						#end
					</td>
					<td style="padding: 0 0.25em;">[&nbsp;<a href="codeDl/$c.fileName?path=$upPath&stamp=$c.uploadStamp" target="_blank">Download</a>&nbsp;]</td>
				</tr>
#end
			</tbody></table>
		</div>
		<div style="float: right;">
			<h3>Report Uploads</h3>
			<table cellspacing="0" align="center"><tbody>
				<tr>
					<th></th>
					<th>Date</th>
					<th>State</th>
					<th>Link</th>
				</tr>
#foreach($rep in $reports.values())
				<tr>
					<td style="padding: 0 0.25em; text-align: center;">#if($rep.uploadStamp == $stamp)<span style="font-weight: bold;">*</span>#else<a href="approve?path=$path&id=$id&stamp=$rep.uploadStamp&codeStamp=$codeStamp">~</a>#end </td>
					<td style="padding: 0 0.25em;"><span title="$rep.niceUploadStamp">$rep.briefUploadStamp</span></td>
					<td style="padding: 0 0.25em;">&nbsp;</td>
					<td style="padding: 0 0.25em;">[&nbsp;<a href="reportDl/$rep.fileName?path=$upPath&stamp=$rep.uploadStamp" target="_blank">Download</a>&nbsp;]</td>
				</tr>
#end
			</tbody></table>
		</div>
	</div>
</div>
</body>
</html>
