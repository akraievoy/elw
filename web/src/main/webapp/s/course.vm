#* @vtlvariable name="elw_messages" type="elw.miniweb.Message[]" *#
#* @vtlvariable name="elw_ctx" type="elw.dao.Ctx" *#
#parse("t/elw.macro.vm")
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<meta content="text/html; charset=UTF-8">
	<title>Course ${elw_ctx.course.name} Structure</title>
	<link href="../css/elw.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<div id="header">
	<div id="nav"><a href="courses">My Courses</a> &gt; <span style="font-weight: bold">${elw_ctx.course.name}</span></div>
	#elw_cred_stud($elw_ctx)
	<div style="clear: both;">&nbsp;</div>
</div>
#elw_messages($elw_messages)
<div id=main>
	<table cellspacing="0"><tbody>
	<tr><td style="padding-left: 1em;" colspan=4>Assignment bundles:</td></tr>
	#foreach($assBundle in $elw_ctx.course.assBundles)#set($bunI = $velocityCount - 1)
	<tr><td style="padding-left: 1.25em;" colspan=4>Assignments:</td></tr>
	 #foreach($ass in $assBundle.assignments)#set($assI = $velocityCount)
		#if($ass.id)
			#if($ass.shared)
	<tr class="header">
		<td style="padding-left: 2em; padding-right: 1em; border-right: #999999 dashed 1px;">
		$ass.name
		</td>
		<td style="padding-left: 0.25em; padding-right: 0.25em; text-align: center; text-align:center;"  colspan=2>
			#if(!$elw_ctx.enr.classes.get($ass.scoring.classFrom).started)Opens $elw_ctx.enr.classes.get($ass.scoring.classFrom).niceDate#end &nbsp;
		</td>
	  <td style="padding-left: 0.25em; padding-right: 0.25em; ">&nbsp;</td>
	</tr>
				#if($elw_ctx.enr.classes.get($ass.scoring.classFrom).started)
					#foreach($ver in $ass.versions)#set($verI = $velocityCount)
						#if($ver.id)
	<tr>
		<td style="padding-left: 2.5em; padding-right: 1em; border-right: #999999 dashed 1px;">$ver.name</td>
		<td style="padding-left: 0.25em; padding-right: 0.25em; text-align: right;">[&nbsp;<a href="launch?elw_ctx=$elw_ctx.extendBAV($bunI, $ass, $ver)">Code</a>&nbsp;]</td>
		<td style="padding-left: 0.25em; padding-right: 0.25em;">&nbsp;</td>
		<td style="padding-left: 0.25em; padding-right: 0.25em;">&nbsp;</td>
	</tr>
						#end
			 		#end
				#end
			#else
	<tr class="header">
		<td style="padding-left: 2em; padding-right: 1em; border-right: #999999 dashed 1px;">$ass.name</td>
				#if($elw_ctx.enr.classes.get($ass.scoring.classFrom).started)
		<td style="padding-left: 0.25em; padding-right: 0.25em; text-align: center;">
			Due $elw_ctx.enr.classes.get($ass.scoring.classCodeDue).niceDate
		</td>
		<td style="padding-left: 0.25em; padding-right: 0.25em; text-align: center;">
			Due $elw_ctx.enr.classes.get($ass.scoring.classReportDue).niceDate
		</td>
				#else
		<td style="padding-left: 0.25em; padding-right: 0.25em; text-align: center;" colspan="2">
			Opens $elw_ctx.enr.classes.get($ass.scoring.classFrom).niceDate
		</td>
				#end
		<td style="padding-left: 0.25em; padding-right: 0.25em; text-align: right;">$ass.scoring.scoreBudget pts.</td>
	</td></tr>
				#if($elw_ctx.enr.classes.get($ass.scoring.classFrom).started)
					#set($verIdx = $elw_ctx.student.idAsInt % $ass.versions.size())
					#set($ver = $ass.versions.get($verIdx))
					#set($path = "$elw_ctx.extendBAV($bunI, $ass, $ver).toString()")
					#set($codeMeta = $codeMetas.get($path))
					#set($reportMeta = $reportMetas.get($path))
	<tr>
		<td style="padding-left: 2.5em; padding-right: 1em; border-right: #999999 dashed 1px;">$ver.name</td>
		<td style="padding-left: 0.25em; padding-right: 0.25em; text-align: right;">
			$codeMeta.totalUploads upload#if($codeMeta.totalUploads != 1)s#end#if($codeMeta.totalUploads > 0), #if($codeMeta.totalUploads > 1)last#{else}on#end <span title="$codeMeta.niceUploadStamp">$codeMeta.briefUploadStamp</span><br/>
				#if($codeMeta.validatorStamp > 0)
					#set($passColor = "#if($codeMeta.testsPassed>0)#00FF00#else#999999#end")
					#set($failColor = "#if($codeMeta.testsFailed>0)#FF0000#else#999999#end")
					<span style="color: $passColor;">$codeMeta.testsPassed&nbsp;Pass</span> /
					<span style="color: $failColor;">$codeMeta.testsFailed&nbsp;Fail</span>
				#else
					Tests Pending
				#end
			#end
			[&nbsp;<a href="launch?elw_ctx=$path">Code</a>&nbsp;]
		</td>
		<td style="padding-left: 0.25em; padding-right: 0.25em; text-align: right;">
			$reportMeta.totalUploads upload#if($reportMeta.totalUploads != 1)s#end#if($reportMeta.totalUploads > 0), #if($reportMeta.totalUploads > 1)last#{else}on#end $reportMeta.niceUploadStamp<br/>
				Approval Pending
			#end
			[&nbsp;<a href="uploadPage?elw_ctx=$path">Report</a>&nbsp;]
		</td>
		<td style="padding-left: 0.25em; padding-right: 0.25em; text-align: right;">&nbsp;</td>
	</tr>
				#end
			#end
		#end
	 #end
	#end
	</tbody></table>
</div>
</body>
</html>