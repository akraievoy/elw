#* @vtlvariable name="elw_messages" type="elw.miniweb.Message[]" *#
#* @vtlvariable name="elw_ctx" type="elw.dao.Ctx" *#
#parse("t/elw.macro.vm")
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<meta content="text/html; charset=UTF-8">
	<title>Course ${elw_ctx.course.name} Structure</title>
	<link href="../css/elw.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<div id="header">
	<div id="nav"><a href="courses">My Courses</a> &gt; <span style="font-weight: bold">${elw_ctx.course.name}</span>
	</div>
	#elw_cred_stud($elw_ctx)
	<div id="header_hr"></div>
</div>
	#elw_messages($elw_messages)
<div id=main>
	<table cellspacing="0">
		<tbody>
		<tr>
			<th>Name</th>
			<th>State</th>
			<th>Score</th>
		</tr>
			#foreach($entry in $elw_ctx.enr.index)#set($idx = $velocityCount - 1)
				#set($ass_ctx = $elw_ctx.extendIndex($idx))
				#set($assType = $ass_ctx.assType)
				#set($ass = $ass_ctx.ass)
				#set($verIdx = $elw_ctx.student.idAsInt % $ass.versions.size())
				#set($ver = $ass.versions.get($verIdx))
				#set($path = $elw_ctx.extendBAV($bunI, $ass, $ver))
				#set($started = $elw_ctx.enr.classes.get($ass_ctx.indexEntry.classFrom).started)
			<tr class="header">
				<td style="padding-left: 2em; padding-right: 1em; border-right: #999999 dashed 1px;">$assType.name - $ass.name</td>
				<td style="padding: 0 0.25em; text-align: left;">
					#if($started) Opened #else Opens #end $elw_ctx.enr.classes.get($ass_ctx.indexEntry.classFrom).niceDate
				</td>
				<td style="padding: 0 0.25em; text-align: right;">$ass_ctx.indexEntry.scoreBudget pts.</td>
			</tr>
				#if($elw_ctx.enr.classes.get($ass_ctx.indexEntry.classFrom).started)
				<tr>
					<td style="padding-left: 2.5em; padding-right: 1em; border-right: #999999 dashed 1px;">$ver.name</td>
#*
					<td style="padding: 0 0.25em; text-align: right;">
						#elw_code_state($path, $codeMetas.get("$path"))
						#if($scores.get("$path"))
							<span style="font-size: smaller;">#elw_code_score($path, $scores.get("$path"))</span>
						#end
					</td>
					<td style="padding: 0 0.25em; text-align: right;">
						#elw_report_state($path, $reportMetas.get("$path"))
						#if($scores.get("$path"))
							<span style="font-size: smaller;">#elw_report_score($path, $scores.get("$path"))</span>
						#end
					</td>
*#
					<td style="padding: 0 0.25em; text-align: right;">
						#if($scores.get("$path"))
							#elw_score($path, $scores.get("$path"))
						#else
							&nbsp;
						#end
					</td>
					<td style="padding: 0 0.25em; text-align: right;">
						<form action="launch" method="get" style="display: inline; margin: 0;">
							<input type="hidden" name="elw_ctx" value="$path"/>
							<input type="submit" value="Code"/>
						</form>
						<form action="uploadPage" method="get" style="display: inline; margin: 0;">
							<input type="hidden" name="elw_ctx" value="$path"/>
							<input type="submit" value="Report"/>
						</form>
					</td>
				</tr>
				#end
			#end
		<tr>
			<td style="padding-left: 1em;" colspan=3>Total Score:</td>
			<td style="padding: 0 0.25em;">$grossScore</td>
			<td style="padding: 0 0.25em;">&nbsp;</td>
		</tr>
		</tbody>
	</table>
</div>
</body>
</html>